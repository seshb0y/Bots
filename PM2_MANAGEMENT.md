# –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Discord –±–æ—Ç–æ–º —á–µ—Ä–µ–∑ PM2

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

–ë–æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–∏—Å—Ç–µ–º—ã —á–µ—Ä–µ–∑ PM2.

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
./bot-manager.sh [–∫–æ–º–∞–Ω–¥–∞]

# –ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ PM2
pm2 [–∫–æ–º–∞–Ω–¥–∞] alliance-bot
```

### –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `start` | –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ |
| `stop` | –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–æ—Ç–∞ |
| `restart` | –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ |
| `status` | –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å |
| `logs` | –ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏ (20 —Å—Ç—Ä–æ–∫) |
| `build` | –°–æ–±—Ä–∞—Ç—å –ø—Ä–æ–µ–∫—Ç |
| `build-restart` | –°–æ–±—Ä–∞—Ç—å –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å |

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```bash
# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
./bot-manager.sh start

# –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç—É—Å–∞
./bot-manager.sh status

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
./bot-manager.sh logs

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
./bot-manager.sh build-restart
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –°—Ç–∞—Ç—É—Å –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
```bash
pm2 status
```

### –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
```bash
pm2 logs alliance-bot --follow
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤
```bash
pm2 monit
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–§–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏: `/opt/discord-bot/ecosystem.config.js`

### –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
- **–ò–º—è –ø—Ä–æ—Ü–µ—Å—Å–∞**: `alliance-bot`
- **–°–∫—Ä–∏–ø—Ç**: `/opt/discord-bot/dist/index.js`
- **–†–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è**: `/opt/discord-bot`
- **–ê–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫**: –≤–∫–ª—é—á–µ–Ω
- **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø–∞–º—è—Ç—å**: 1GB
- **–õ–æ–≥–∏**: `/opt/discord-bot/logs/`

## üîÑ –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫

PM2 –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–∏—Å—Ç–µ–º—ã:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞
systemctl status pm2-root

# –û—Ç–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
pm2 unstartup systemd

# –í–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ –æ–±—Ä–∞—Ç–Ω–æ
pm2 startup
pm2 save
```

## üìù –õ–æ–≥–∏

–õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ø–∞–ø–∫–µ `/opt/discord-bot/logs/`:
- `out-0.log` - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤—ã–≤–æ–¥
- `err-0.log` - –æ—à–∏–±–∫–∏
- `combined.log` - –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–µ –ª–æ–≥–∏

## üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞

1. –í–Ω–µ—Å–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥
2. –°–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç: `./bot-manager.sh build`
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞: `./bot-manager.sh restart`

–ò–ª–∏ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π: `./bot-manager.sh build-restart`

### –û—Ç–ª–∞–¥–∫–∞

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –æ—à–∏–±–æ–∫
pm2 logs alliance-bot --err --lines 50

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å –æ—á–∏—Å—Ç–∫–æ–π –ª–æ–≥–æ–≤
pm2 flush alliance-bot
pm2 restart alliance-bot
```

## ‚ö†Ô∏è –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ë–æ—Ç –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø—Ä–æ–µ–∫—Ç —Å–æ–±—Ä–∞–Ω: `ls -la dist/`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `pm2 logs alliance-bot`
3. –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç: `./bot-manager.sh build`

### –û—à–∏–±–∫–∏ –º–æ–¥—É–ª–µ–π
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã: `npm install`
2. –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç: `npm run build:prod`

### –ü—Ä–æ–±–ª–µ–º—ã —Å –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–æ–º
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å: `systemctl status pm2-root`
2. –ü–µ—Ä–µ—Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é: `pm2 save`
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å: `systemctl restart pm2-root`
